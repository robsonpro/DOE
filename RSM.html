<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robson Bruno Dutra Pereira">

<title>Metodologia de superfície de resposta</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="RSM_files/libs/clipboard/clipboard.min.js"></script>
<script src="RSM_files/libs/quarto-html/quarto.js"></script>
<script src="RSM_files/libs/quarto-html/popper.min.js"></script>
<script src="RSM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="RSM_files/libs/quarto-html/anchor.min.js"></script>
<link href="RSM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RSM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="RSM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="RSM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="RSM_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Metodologia de superfície de resposta</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robson Bruno Dutra Pereira </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="exemplo-rsm-k-2-planejamento-ccd" class="level2">
<h2 class="anchored" data-anchor-id="exemplo-rsm-k-2-planejamento-ccd">Exemplo RSM, k = 2, planejamento CCD</h2>
<p>Determinação de cobre em diferentes amostras de água por espectrometria de emissão óptica.</p>
<ul>
<li>x1: pH</li>
<li>x2: vazão - vz (mL/min)</li>
</ul>
<p>Resposta (y): sinal analítico resultante das medições de altura de pico instrumental. O maior foi considerado como 100% e os demais como percentual relativo a este.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rsm' was built under R version 4.3.3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ccd1 <span class="ot">&lt;-</span> <span class="fu">ccd</span>(<span class="at">basis =</span> <span class="sc">~</span>x1<span class="sc">+</span>x2,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">n0 =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="st">"rotatable"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">randomize =</span> F,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">oneblock =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">coding =</span> <span class="fu">list</span>(x1 <span class="sc">~</span> (vz <span class="sc">-</span> <span class="dv">8</span>)<span class="sc">/</span><span class="dv">1</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                          x2 <span class="sc">~</span> (pH <span class="sc">-</span> <span class="dv">8</span>)<span class="sc">/</span><span class="dv">1</span>))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">68.64</span>, <span class="fl">69.82</span>, <span class="fl">81.66</span>, <span class="fl">85.80</span>, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>       <span class="fl">79.29</span>, <span class="fl">87.57</span>, <span class="fl">74.56</span>, <span class="fl">94.08</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>       <span class="dv">100</span>, <span class="fl">99.41</span>, <span class="dv">100</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>ccd1<span class="sc">$</span>y <span class="ot">&lt;-</span> y</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>ccd1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   run.order std.order       vz       pH      y
1          1         1 7.000000 7.000000  68.64
2          2         2 9.000000 7.000000  69.82
3          3         3 7.000000 9.000000  81.66
4          4         4 9.000000 9.000000  85.80
5          1         1 6.585786 8.000000  79.29
6          2         2 9.414214 8.000000  87.57
7          3         3 8.000000 6.585786  74.56
8          4         4 8.000000 9.414214  94.08
9          5         5 8.000000 8.000000 100.00
10         6         6 8.000000 8.000000  99.41
11         7         7 8.000000 8.000000 100.00

Data are stored in coded form using these coding formulas ...
x1 ~ (vz - 8)/1
x2 ~ (pH - 8)/1</code></pre>
</div>
</div>
<p>Modelagem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span><span class="fu">SO</span>(x1,x2), <span class="at">data =</span> ccd1)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ SO(x1, x2), data = ccd1)

Residuals:
      1       2       3       4       5       6       7       8       9      10 
-3.0731 -4.6705 -2.7245 -4.3219  2.5680  4.8270  3.9440  3.4510  0.1967 -0.3933 
     11 
 0.1967 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       99.803      2.768  36.052 3.09e-07 ***
SO(x1, x2)x1       2.129      1.695   1.256  0.26470    
SO(x1, x2)x2       7.076      1.695   4.174  0.00871 ** 
SO(x1, x2)x1:x2    0.740      2.397   0.309  0.77002    
SO(x1, x2)x1^2   -10.035      2.018  -4.974  0.00420 ** 
SO(x1, x2)x2^2    -9.590      2.018  -4.753  0.00509 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.795 on 5 degrees of freedom
Multiple R-squared:  0.9176,    Adjusted R-squared:  0.8352 
F-statistic: 11.14 on 5 and 5 DF,  p-value: 0.009668</code></pre>
</div>
</div>
<p>Modelagem usando comando <code>rsm</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rsm1 <span class="ot">&lt;-</span> <span class="fu">rsm</span>(y<span class="sc">~</span><span class="fu">SO</span>(x1,x2), <span class="at">data =</span> ccd1)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rsm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rsm(formula = y ~ SO(x1, x2), data = ccd1)

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  99.8033     2.7683 36.0525 3.091e-07 ***
x1            2.1287     1.6952  1.2557  0.264704    
x2            7.0757     1.6952  4.1739  0.008706 ** 
x1:x2         0.7400     2.3974  0.3087  0.770021    
x1^2        -10.0354     2.0177 -4.9737  0.004199 ** 
x2^2         -9.5904     2.0177 -4.7531  0.005090 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Multiple R-squared:  0.9176,    Adjusted R-squared:  0.8352 
F-statistic: 11.14 on 5 and 5 DF,  p-value: 0.009668

Analysis of Variance Table

Response: y
            Df Sum Sq Mean Sq  F value   Pr(&gt;F)
FO(x1, x2)   2 436.77  218.39   9.4991 0.019814
TWI(x1, x2)  1   2.19    2.19   0.0953 0.770021
PQ(x1, x2)   2 841.17  420.59  18.2941 0.005012
Residuals    5 114.95   22.99                  
Lack of fit  3 114.72   38.24 329.5566 0.003027
Pure error   2   0.23    0.12                  

Stationary point of response surface:
       x1        x2 
0.1198313 0.3735164 

Stationary point in original units:
      vz       pH 
8.119831 8.373516 

Eigenanalysis:
eigen() decomposition
$values
[1]  -9.381169 -10.244665

$vectors
         [,1]       [,2]
x1 -0.4922667 -0.8704444
x2 -0.8704444  0.4922667</code></pre>
</div>
</div>
<p>Condições de otimalidade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">canonical</span>(rsm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$xs
       x1        x2 
0.1198313 0.3735164 

$eigen
eigen() decomposition
$values
[1]  -9.381169 -10.244665

$vectors
         [,1]       [,2]
x1 -0.4922667 -0.8704444
x2 -0.8704444  0.4922667</code></pre>
</div>
</div>
<p>Modelo reduzido.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rsm2 <span class="ot">&lt;-</span> <span class="fu">rsm</span>(y<span class="sc">~</span><span class="fu">FO</span>(x1,x2)<span class="sc">+</span><span class="fu">PQ</span>(x1,x2), <span class="at">data =</span> ccd1)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rsm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rsm(formula = y ~ FO(x1, x2) + PQ(x1, x2), data = ccd1)

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  99.8033     2.5510 39.1225 1.863e-08 ***
x1            2.1287     1.5622  1.3626  0.221920    
x2            7.0757     1.5622  4.5293  0.003978 ** 
x1^2        -10.0354     1.8594 -5.3972  0.001668 ** 
x2^2         -9.5904     1.8594 -5.1579  0.002099 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Multiple R-squared:  0.916, Adjusted R-squared:  0.8601 
F-statistic: 16.36 on 4 and 6 DF,  p-value: 0.002219

Analysis of Variance Table

Response: y
            Df Sum Sq Mean Sq F value   Pr(&gt;F)
FO(x1, x2)   2 436.77  218.39  11.186 0.009458
PQ(x1, x2)   2 841.17  420.59  21.543 0.001826
Residuals    6 117.14   19.52                 
Lack of fit  4 116.91   29.23 251.887 0.003958
Pure error   2   0.23    0.12                 

Stationary point of response surface:
       x1        x2 
0.1060599 0.3688933 

Stationary point in original units:
      vz       pH 
8.106060 8.368893 

Eigenanalysis:
eigen() decomposition
$values
[1]  -9.590417 -10.035417

$vectors
   [,1] [,2]
x1    0   -1
x2   -1    0</code></pre>
</div>
</div>
<p>Pressuposições.</p>
<p>Normalidade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(rsm2<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  rsm2$residuals
W = 0.94737, p-value = 0.6106</code></pre>
</div>
</div>
<p>Homocedasticidade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'olsrr' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'olsrr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    rivers</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span><span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>), ccd1)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_breusch_pagan</span>(lm2, <span class="at">rhs=</span>T, <span class="at">multiple=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

              Data               
 --------------------------------
 Response : y 
 Variables: x1 x2 I(x1^2) I(x2^2) 

        Test Summary (Unadjusted p values)       
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  x1               1.2848366     1    0.2570017 
  x2               0.1246822     1    0.7240107 
  I(x1^2)          0.8315588     1    0.3618222 
  I(x2^2)          0.6116737     1    0.4341583 
 ----------------------------------------------
  simultaneous     3.4486734     4    0.4857255 
 ----------------------------------------------</code></pre>
</div>
</div>
<p>Gráficos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rsm2, <span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">image=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(rsm2, <span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">50</span>),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">contours =</span> <span class="st">"colors"</span>, <span class="at">zlab =</span> <span class="st">"y (%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comandos básicos para encontrar o pnto estacionário e fazer análise de otimalidade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> rsm2<span class="sc">$</span>b</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> rsm2<span class="sc">$</span>B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ponto estacionário.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># xs &lt;- canonical(rsm2)$xs</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">solve</span>(B)<span class="sc">%*%</span>b</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>xs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]
x1 0.1060599
x2 0.3688933</code></pre>
</div>
</div>
<p>Autovalores de B.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1]  -9.590417 -10.035417

$vectors
     [,1] [,2]
[1,]    0   -1
[2,]   -1    0</code></pre>
</div>
</div>
<p>Previsão no ponto estacionário.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(rsm2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> xs[<span class="dv">1</span>],</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x2 =</span> xs[<span class="dv">2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
101.2213 </code></pre>
</div>
</div>
<p>Gráfico de perspectiva passo a passo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(ccd1<span class="sc">$</span>x1), <span class="fu">max</span>(ccd1<span class="sc">$</span>x1), <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ys <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(ccd1<span class="sc">$</span>x2), <span class="fu">max</span>(ccd1<span class="sc">$</span>x2), <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>xys <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> xs, <span class="at">x2 =</span> ys)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>zs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">predict</span>(rsm2, <span class="at">newdata =</span> xys), <span class="at">nrow =</span> <span class="fu">length</span>(xs))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>n.cols <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"greenyellow"</span>, <span class="st">"slateblue"</span>))(n.cols)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>zfacet <span class="ot">&lt;-</span> zs[<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">+</span> zs[<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">20</span>] <span class="sc">+</span> zs[<span class="sc">-</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">+</span> zs[<span class="sc">-</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">20</span>]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>facetcol <span class="ot">&lt;-</span> <span class="fu">cut</span>(zfacet, n.cols)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">persp</span>(<span class="at">x=</span>xs, <span class="at">y=</span>ys, <span class="at">z=</span>zs, <span class="at">theta=</span><span class="dv">300</span>, <span class="at">phi=</span><span class="dv">30</span>, <span class="at">ticktype=</span><span class="st">'detailed'</span>, </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"vz"</span>, <span class="at">ylab=</span><span class="st">"pH"</span>, <span class="at">zlab=</span><span class="st">"y[%]"</span>, <span class="at">col =</span> palette[facetcol])</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ccd1, <span class="fu">points</span>(<span class="fu">trans3d</span>(x1,x2,y,p1), <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col =</span> <span class="st">"tomato"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x1</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>x1_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(ccd1<span class="sc">$</span>x1), <span class="fu">max</span>(ccd1<span class="sc">$</span>x1), <span class="fl">0.1</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>center_grid <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(x1_grid))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> (<span class="fu">predict</span>(rsm2,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x1_grid, </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">x2 =</span> center_grid)))),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'firebrick1'</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"vz [mL/min]"</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"sinal [%]"</span>) <span class="sc">+</span> </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">58</span>,<span class="dv">103</span>) <span class="sc">+</span> </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co"># p1</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span>        </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid, </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> (<span class="fu">predict</span>(rsm2,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x2 =</span> x1_grid, </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">x1 =</span> center_grid)))),</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">'dodgerblue3'</span>) <span class="sc">+</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"pH"</span>) <span class="sc">+</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"sinal [%]"</span>) <span class="sc">+</span> </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">58</span>,<span class="dv">103</span>) <span class="sc">+</span> </span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co"># p2</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid, </span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">predict</span>(rsm2, </span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x2 =</span> x1_grid, </span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">x1 =</span> center_grid)),</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"8"</span>, <span class="at">linetype =</span> <span class="st">"8"</span>)) <span class="sc">+</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">''</span>) <span class="sc">+</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'pH'</span>) <span class="sc">+</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'sinal [%]'</span>) <span class="sc">+</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">58</span>,<span class="dv">103</span>) <span class="sc">+</span> </span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>x2_grid_1 <span class="ot">=</span> <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fu">length</span>(x1_grid))</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>x2_grid1 <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(x1_grid))</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> p12 <span class="sc">+</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid,</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">predict</span>(rsm2,</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x2 =</span> x1_grid,</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">x1 =</span> x2_grid_1)),</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"7"</span>, <span class="at">linetype =</span> <span class="st">"7"</span>)) <span class="sc">+</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_grid, </span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">predict</span>(rsm2, </span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x2 =</span> x1_grid, </span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">x1 =</span> x2_grid1)),</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"9"</span>, <span class="at">linetype =</span> <span class="st">"9"</span>)) <span class="sc">+</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"vz"</span>, </span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"orange1"</span>, <span class="st">"8"</span> <span class="ot">=</span> <span class="st">"green3"</span>, <span class="st">"9"</span> <span class="ot">=</span> <span class="st">"red1"</span>)) <span class="sc">+</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"vz"</span>, </span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"7"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"8"</span> <span class="ot">=</span> <span class="st">"longdash"</span>, <span class="st">"9"</span> <span class="ot">=</span> <span class="st">"solid"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a><span class="co"># p12    </span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggpubr' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1,p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>p12</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ccd-com-k-4-fatores" class="level2">
<h2 class="anchored" data-anchor-id="ccd-com-k-4-fatores">CCD, com k = 4 fatores</h2>
<p>Recuperação de titânio em um processo de lixiviação.</p>
<p>x1: temperatura (ºC) x2: tempo (min) x3: concentração (mol/L) x4: razão de sólido/líquido (gr/L), 1 gr = 64.8 mg</p>
<p>y: recuperação de titânio observada (%)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsm)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>ccd1 <span class="ot">&lt;-</span> <span class="fu">ccd</span>(<span class="at">basis =</span> <span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3<span class="sc">+</span>x4,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n0 =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">randomize =</span> F,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="st">"rotatable"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">coding =</span> <span class="fu">list</span>(x1 <span class="sc">~</span> (Temp <span class="sc">-</span> <span class="dv">95</span>)<span class="sc">/</span><span class="dv">15</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                          x2 <span class="sc">~</span> (Time <span class="sc">-</span> <span class="dv">240</span>)<span class="sc">/</span><span class="dv">60</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                          x3 <span class="sc">~</span> (C <span class="sc">-</span> <span class="dv">8</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                          x4 <span class="sc">~</span> (r <span class="sc">-</span> <span class="dv">15</span>)<span class="sc">/</span><span class="dv">5</span>))</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>ccd1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">13.21</span>, <span class="fl">30.5</span>, <span class="fl">18.72</span>, <span class="fl">42.61</span>, <span class="fl">13.85</span>, <span class="fl">46.27</span>, <span class="fl">17.46</span>, <span class="fl">53.73</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>            <span class="fl">12.82</span>, <span class="fl">22.53</span>, <span class="fl">20.69</span>, <span class="fl">34.32</span>, <span class="fl">9.45</span>, <span class="fl">30.54</span>, <span class="fl">10.58</span>, <span class="fl">40.83</span>, </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>            <span class="fl">5.5</span>, <span class="fl">49.62</span>, <span class="fl">13.16</span>, <span class="fl">27.23</span>, <span class="fl">16.15</span>, <span class="fl">22.96</span>, <span class="fl">32.16</span>, <span class="fl">17.94</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>            <span class="fl">21.62</span>, <span class="fl">21.13</span>, <span class="fl">21.21</span>, <span class="fl">19.28</span>, <span class="fl">20.84</span>, <span class="fl">20.45</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Análise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>rsm1 <span class="ot">&lt;-</span> <span class="fu">rsm</span>(y <span class="sc">~</span> <span class="fu">SO</span>(x1,x2,x3,x4), <span class="at">data =</span> ccd1)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rsm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rsm(formula = y ~ SO(x1, x2, x3, x4), data = ccd1)

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) 20.75500    0.81271 25.5381 8.908e-14 ***
x1          11.36625    0.40635 27.9713 2.336e-14 ***
x2           3.66292    0.40635  9.0141 1.923e-07 ***
x3           1.70542    0.40635  4.1969 0.0007778 ***
x4          -3.45958    0.40635 -8.5137 3.968e-07 ***
x1:x2        1.47063    0.49768  2.9550 0.0098337 ** 
x1:x3        3.46938    0.49768  6.9711 4.492e-06 ***
x1:x4       -2.19937    0.49768 -4.4193 0.0004974 ***
x2:x3       -0.92438    0.49768 -1.8574 0.0830014 .  
x2:x4        0.14937    0.49768  0.3001 0.7681875    
x3:x4       -1.57688    0.49768 -3.1685 0.0063616 ** 
x1^2         2.20823    0.38011  5.8095 3.441e-05 ***
x2^2         0.36698    0.38011  0.9655 0.3496240    
x3^2         0.20698    0.38011  0.5445 0.5940828    
x4^2         1.58073    0.38011  4.1586 0.0008403 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Multiple R-squared:  0.9864,    Adjusted R-squared:  0.9738 
F-statistic: 77.84 on 14 and 15 DF,  p-value: 2.107e-11

Analysis of Variance Table

Response: y
                    Df Sum Sq Mean Sq  F value    Pr(&gt;F)
FO(x1, x2, x3, x4)   4 3779.7  944.91 238.4369 2.226e-13
TWI(x1, x2, x3, x4)  6  358.4   59.73  15.0728 1.374e-05
PQ(x1, x2, x3, x4)   4  180.8   45.19  11.4036 0.0001878
Residuals           15   59.4    3.96                   
Lack of fit         10   56.1    5.61   8.3151 0.0152502
Pure error           5    3.4    0.67                   

Stationary point of response surface:
        x1         x2         x3         x4 
-1.1552851 -3.1157968 -0.3030376  0.2866550 

Stationary point in original units:
     Temp      Time         C         r 
77.670724 53.052195  7.393925 16.433275 

Eigenanalysis:
eigen() decomposition
$values
[1]  3.9971380  1.0660727  0.4845984 -1.1848924

$vectors
         [,1]        [,2]       [,3]        [,4]
x1  0.7548385  0.42500325  0.1425215  0.47883051
x2  0.0875497  0.57836778 -0.6743435 -0.45065131
x3  0.4352385 -0.08703024  0.4852908 -0.75331671
x4 -0.4828264  0.69086082  0.5379975 -0.01219299</code></pre>
</div>
</div>
<p>Modelo com <code>lm</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> (x1<span class="sc">+</span>x2<span class="sc">+</span>x3<span class="sc">+</span>x4)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x3<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">I</span>(x4<span class="sc">^</span><span class="dv">2</span>), ccd1)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ (x1 + x2 + x3 + x4)^2 + I(x1^2) + I(x2^2) + 
    I(x3^2) + I(x4^2), data = ccd1)

Residuals:
   Min     1Q Median     3Q    Max 
-2.700 -1.445  0.415  1.007  2.048 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  20.7550     0.8127  25.538 8.91e-14 ***
x1           11.3662     0.4064  27.971 2.34e-14 ***
x2            3.6629     0.4064   9.014 1.92e-07 ***
x3            1.7054     0.4064   4.197 0.000778 ***
x4           -3.4596     0.4064  -8.514 3.97e-07 ***
I(x1^2)       2.2082     0.3801   5.809 3.44e-05 ***
I(x2^2)       0.3670     0.3801   0.965 0.349624    
I(x3^2)       0.2070     0.3801   0.545 0.594083    
I(x4^2)       1.5807     0.3801   4.159 0.000840 ***
x1:x2         1.4706     0.4977   2.955 0.009834 ** 
x1:x3         3.4694     0.4977   6.971 4.49e-06 ***
x1:x4        -2.1994     0.4977  -4.419 0.000497 ***
x2:x3        -0.9244     0.4977  -1.857 0.083001 .  
x2:x4         0.1494     0.4977   0.300 0.768187    
x3:x4        -1.5769     0.4977  -3.168 0.006362 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 15 degrees of freedom
Multiple R-squared:  0.9864,    Adjusted R-squared:  0.9738 
F-statistic: 77.84 on 14 and 15 DF,  p-value: 2.107e-11</code></pre>
</div>
</div>
<p>Reduzindo o modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">step</span>(lm1, <span class="at">trace =</span> <span class="dv">1</span>, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=50.52
y ~ (x1 + x2 + x3 + x4)^2 + I(x1^2) + I(x2^2) + I(x3^2) + I(x4^2)

          Df Sum of Sq     RSS    AIC
- x2:x4    1     0.357  59.801 48.695
- I(x3^2)  1     1.175  60.619 49.103
- I(x2^2)  1     3.694  63.138 50.324
&lt;none&gt;                  59.444 50.515
- x2:x3    1    13.672  73.116 54.725
- x1:x2    1    34.604  94.048 62.278
- x3:x4    1    39.785  99.229 63.887
- I(x4^2)  1    68.536 127.980 71.520
- x1:x4    1    77.396 136.840 73.529
- I(x1^2)  1   133.749 193.194 83.875
- x1:x3    1   192.585 252.029 91.850

Step:  AIC=48.69
y ~ x1 + x2 + x3 + x4 + I(x1^2) + I(x2^2) + I(x3^2) + I(x4^2) + 
    x1:x2 + x1:x3 + x1:x4 + x2:x3 + x3:x4

          Df Sum of Sq     RSS    AIC
- I(x3^2)  1     1.175  60.976 47.279
- I(x2^2)  1     3.694  63.495 48.493
&lt;none&gt;                  59.801 48.695
- x2:x3    1    13.672  73.473 52.872
- x1:x2    1    34.604  94.405 60.392
- x3:x4    1    39.785  99.586 61.995
- I(x4^2)  1    68.536 128.337 69.604
- x1:x4    1    77.396 137.197 71.607
- I(x1^2)  1   133.749 193.551 81.930
- x1:x3    1   192.585 252.386 89.893

Step:  AIC=47.28
y ~ x1 + x2 + x3 + x4 + I(x1^2) + I(x2^2) + I(x4^2) + x1:x2 + 
    x1:x3 + x1:x4 + x2:x3 + x3:x4

          Df Sum of Sq     RSS    AIC
- I(x2^2)  1     3.188  64.164 46.807
&lt;none&gt;                  60.976 47.279
- x2:x3    1    13.672  74.648 51.348
- x1:x2    1    34.604  95.580 58.763
- x3:x4    1    39.785 100.761 60.347
- I(x4^2)  1    67.371 128.347 67.606
- x1:x4    1    77.396 138.372 69.863
- I(x1^2)  1   132.904 193.880 79.981
- x1:x3    1   192.585 253.561 88.032

Step:  AIC=46.81
y ~ x1 + x2 + x3 + x4 + I(x1^2) + I(x4^2) + x1:x2 + x1:x3 + x1:x4 + 
    x2:x3 + x3:x4

          Df Sum of Sq     RSS    AIC
&lt;none&gt;                  64.164 46.807
- x2:x3    1    13.672  77.836 50.602
- x1:x2    1    34.604  98.768 57.747
- x3:x4    1    39.785 103.949 59.281
- I(x4^2)  1    64.769 128.933 65.743
- x1:x4    1    77.396 141.560 68.546
- I(x1^2)  1   129.837 194.001 78.000
- x1:x3    1   192.585 256.749 86.407</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2 + x3 + x4 + I(x1^2) + I(x4^2) + x1:x2 + 
    x1:x3 + x1:x4 + x2:x3 + x3:x4, data = ccd1)

Residuals:
   Min     1Q Median     3Q    Max 
-2.987 -1.288  0.298  1.296  2.341 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  21.3290     0.5450  39.134  &lt; 2e-16 ***
x1           11.3662     0.3854  29.493  &lt; 2e-16 ***
x2            3.6629     0.3854   9.504 1.94e-08 ***
x3            1.7054     0.3854   4.425 0.000327 ***
x4           -3.4596     0.3854  -8.977 4.58e-08 ***
I(x1^2)       2.1365     0.3540   6.035 1.05e-05 ***
I(x4^2)       1.5090     0.3540   4.263 0.000468 ***
x1:x2         1.4706     0.4720   3.116 0.005971 ** 
x1:x3         3.4694     0.4720   7.350 8.01e-07 ***
x1:x4        -2.1994     0.4720  -4.660 0.000195 ***
x2:x3        -0.9244     0.4720  -1.958 0.065866 .  
x3:x4        -1.5769     0.4720  -3.341 0.003638 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.888 on 18 degrees of freedom
Multiple R-squared:  0.9853,    Adjusted R-squared:  0.9764 
F-statistic:   110 on 11 and 18 DF,  p-value: 3.571e-14</code></pre>
</div>
</div>
<p>Modelo reduzido com rsm.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rsm2 <span class="ot">&lt;-</span> <span class="fu">rsm</span>(y <span class="sc">~</span> <span class="fu">FO</span>(x1,x2,x3,x4) <span class="sc">+</span> <span class="fu">PQ</span>(x1,x4) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">TWI</span>(<span class="at">formula =</span> <span class="sc">~</span> x1<span class="sc">*</span>x2<span class="sc">+</span>x1<span class="sc">*</span>x3<span class="sc">+</span>x1<span class="sc">*</span>x4<span class="sc">+</span>x2<span class="sc">*</span>x3<span class="sc">+</span>x3<span class="sc">*</span>x4),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>             ccd1)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rsm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rsm(formula = y ~ FO(x1, x2, x3, x4) + PQ(x1, x4) + TWI(formula = ~x1 * 
    x2 + x1 * x3 + x1 * x4 + x2 * x3 + x3 * x4), data = ccd1)

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) 21.32896    0.54503 39.1337 &lt; 2.2e-16 ***
x1          11.36625    0.38539 29.4926 &lt; 2.2e-16 ***
x2           3.66292    0.38539  9.5044 1.941e-08 ***
x3           1.70542    0.38539  4.4251 0.0003268 ***
x4          -3.45958    0.38539 -8.9768 4.577e-08 ***
x1^2         2.13648    0.35401  6.0352 1.049e-05 ***
x4^2         1.50898    0.35401  4.2626 0.0004684 ***
x1:x2        1.47063    0.47201  3.1157 0.0059709 ** 
x1:x3        3.46938    0.47201  7.3502 8.013e-07 ***
x1:x4       -2.19937    0.47201 -4.6596 0.0001950 ***
x2:x3       -0.92438    0.47201 -1.9584 0.0658663 .  
x3:x4       -1.57688    0.47201 -3.3408 0.0036384 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Multiple R-squared:  0.9853,    Adjusted R-squared:  0.9764 
F-statistic:   110 on 11 and 18 DF,  p-value: 3.571e-14

Analysis of Variance Table

Response: y
                                                                Df Sum Sq
FO(x1, x2, x3, x4)                                               4 3779.7
PQ(x1, x4)                                                       2  176.4
TWI(formula = ~x1 * x2 + x1 * x3 + x1 * x4 + x2 * x3 + x3 * x4)  5  358.0
Residuals                                                       18   64.2
Lack of fit                                                     13   60.8
Pure error                                                       5    3.4
                                                                Mean Sq
FO(x1, x2, x3, x4)                                               944.91
PQ(x1, x4)                                                        88.20
TWI(formula = ~x1 * x2 + x1 * x3 + x1 * x4 + x2 * x3 + x3 * x4)   71.61
Residuals                                                          3.56
Lack of fit                                                        4.68
Pure error                                                         0.67
                                                                 F value
FO(x1, x2, x3, x4)                                              265.0777
PQ(x1, x4)                                                       24.7435
TWI(formula = ~x1 * x2 + x1 * x3 + x1 * x4 + x2 * x3 + x3 * x4)  20.0883
Residuals                                                               
Lack of fit                                                       6.9346
Pure error                                                              
                                                                   Pr(&gt;F)
FO(x1, x2, x3, x4)                                              9.912e-16
PQ(x1, x4)                                                      6.831e-06
TWI(formula = ~x1 * x2 + x1 * x3 + x1 * x4 + x2 * x3 + x3 * x4) 8.556e-07
Residuals                                                                
Lack of fit                                                       0.02165
Pure error                                                               

Stationary point of response surface:
        x1         x2         x3         x4 
-1.5917831 -5.3807096  1.4301563  0.7335507 

Stationary point in original units:
     Temp      Time         C         r 
 71.12325 -82.84258  10.86031  18.66775 

Eigenanalysis:
eigen() decomposition
$values
[1]  3.9045619  0.8690338  0.2705675 -1.3986945

$vectors
          [,1]         [,2]        [,3]        [,4]
x1  0.75766933  0.463964900  0.03959957 -0.45728070
x2  0.09248661  0.394310472 -0.77428197  0.48626424
x3  0.42407905 -0.003266963  0.51627016  0.74405068
x4 -0.48738114  0.793249740  0.36384672  0.02881047</code></pre>
</div>
</div>
<p>Gráficos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rsm2, <span class="sc">~</span> x1<span class="sc">+</span>x2<span class="sc">+</span>x3<span class="sc">+</span>x4, <span class="at">image =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(rsm2, <span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3<span class="sc">+</span>x4, <span class="at">zlab =</span> <span class="st">"y(%)"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">cm.colors</span>(<span class="dv">50</span>), <span class="at">contours =</span> <span class="st">"colors"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Otimização restrita.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>otim <span class="ot">&lt;-</span> <span class="fu">steepest</span>(rsm2, <span class="at">dist =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">descent =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Path of steepest ascent from ridge analysis:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>otim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dist    x1    x2    x3     x4 |    Temp   Time     C      r |   yhat
1   0.0 0.000 0.000 0.000  0.000 |  95.000 240.00 8.000 15.000 | 21.329
2   0.1 0.090 0.029 0.015 -0.029 |  96.350 241.74 8.030 14.855 | 22.617
3   0.2 0.180 0.056 0.034 -0.059 |  97.700 243.36 8.068 14.705 | 23.977
4   0.3 0.268 0.082 0.056 -0.091 |  99.020 244.92 8.112 14.545 | 25.394
5   0.4 0.356 0.108 0.079 -0.124 | 100.340 246.48 8.158 14.380 | 26.887
6   0.5 0.443 0.132 0.105 -0.159 | 101.645 247.92 8.210 14.205 | 28.450
7   0.6 0.529 0.155 0.133 -0.195 | 102.935 249.30 8.266 14.025 | 30.080
8   0.7 0.615 0.177 0.162 -0.232 | 104.225 250.62 8.324 13.840 | 31.788
9   0.8 0.701 0.199 0.193 -0.269 | 105.515 251.94 8.386 13.655 | 33.580
10  0.9 0.785 0.219 0.224 -0.308 | 106.775 253.14 8.448 13.460 | 35.419
11  1.0 0.870 0.239 0.257 -0.347 | 108.050 254.34 8.514 13.265 | 37.360
12  1.1 0.953 0.259 0.290 -0.387 | 109.295 255.54 8.580 13.065 | 39.350
13  1.2 1.037 0.277 0.325 -0.428 | 110.555 256.62 8.650 12.860 | 41.443
14  1.3 1.120 0.295 0.359 -0.469 | 111.800 257.70 8.718 12.655 | 43.590
15  1.4 1.202 0.313 0.395 -0.511 | 113.030 258.78 8.790 12.445 | 45.815
16  1.5 1.284 0.330 0.431 -0.553 | 114.260 259.80 8.862 12.235 | 48.113
17  1.6 1.366 0.347 0.467 -0.596 | 115.490 260.82 8.934 12.020 | 50.497
18  1.7 1.448 0.363 0.504 -0.638 | 116.720 261.78 9.008 11.810 | 52.952
19  1.8 1.529 0.379 0.542 -0.682 | 117.935 262.74 9.084 11.590 | 55.490
20  1.9 1.610 0.394 0.579 -0.725 | 119.150 263.64 9.158 11.375 | 58.084
21  2.0 1.691 0.410 0.617 -0.769 | 120.365 264.60 9.234 11.155 | 60.779</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rsm2, <span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">decode =</span> T,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">at =</span> <span class="fu">c</span>(<span class="at">x3 =</span> <span class="fl">0.617</span>, <span class="at">x4 =</span> <span class="sc">-</span><span class="fl">0.769</span>))</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">110</span>,<span class="dv">80</span>,<span class="dv">110</span>,<span class="dv">65</span>,<span class="dv">125</span>,<span class="dv">95</span>,<span class="dv">95</span>,<span class="dv">95</span>), <span class="fu">c</span>(<span class="dv">180</span>,<span class="dv">180</span>,<span class="dv">300</span>,<span class="dv">300</span>,<span class="dv">240</span>,<span class="dv">240</span>,<span class="dv">120</span>,<span class="dv">360</span>,<span class="dv">240</span>),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Time <span class="sc">~</span> Temp, <span class="at">data =</span> otim,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"magenta"</span>, <span class="at">pch =</span> <span class="st">"*"</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rsm2, <span class="sc">~</span>x1<span class="sc">+</span>x3, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">decode =</span> T,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">at =</span> <span class="fu">c</span>(<span class="at">x2 =</span> <span class="fl">0.410</span>   , <span class="at">x4 =</span> <span class="sc">-</span><span class="fl">0.769</span>))</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">110</span>,<span class="dv">80</span>,<span class="dv">110</span>,<span class="dv">65</span>,<span class="dv">125</span>,<span class="dv">95</span>,<span class="dv">95</span>,<span class="dv">95</span>), <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">12</span>,<span class="dv">8</span>),</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(C <span class="sc">~</span> Temp, <span class="at">data =</span> otim,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"magenta"</span>, <span class="at">pch =</span> <span class="st">"*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bbd-k-4" class="level2">
<h2 class="anchored" data-anchor-id="bbd-k-4">BBD, k = 4</h2>
<p>Sinterização de inibição seletiva de peças de polietileno de alta densidade.</p>
<ul>
<li>x1: espessura da camada (mm)</li>
<li>x2: energia do aquecedor (J/mm^2)</li>
<li>x3: velocidade de avanço do aquecedor (mm/s)</li>
<li>x4: velocidade de avanço da impressora (mm/min)</li>
</ul>
<p>y: encolhimento das peças no sentido da largura.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">bbd</span>(<span class="at">k =</span> <span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3<span class="sc">+</span>x4,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">block =</span> F,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">n0 =</span> <span class="dv">5</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">randomize =</span> F,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">coding =</span> <span class="fu">list</span>(x1 <span class="sc">~</span> (Ac <span class="sc">-</span> <span class="fl">0.2</span>)<span class="sc">/</span><span class="fl">0.1</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                            x2 <span class="sc">~</span> (Ea <span class="sc">-</span> <span class="fl">25.32</span>)<span class="sc">/</span><span class="fl">3.16</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                            x3 <span class="sc">~</span> (vf_a <span class="sc">-</span> <span class="fl">3.5</span>)<span class="sc">/</span><span class="fl">0.5</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                            x4 <span class="sc">~</span> (vf_p <span class="sc">-</span> <span class="dv">100</span>)<span class="sc">/</span><span class="dv">20</span>))</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>width <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.3533</span>, <span class="fl">5.2615</span>, <span class="fl">5.0008</span>, <span class="fl">4.2712</span>, <span class="fl">4.5840</span>, <span class="fl">2.7470</span>, <span class="fl">3.8086</span>, <span class="fl">3.9839</span>, </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>           <span class="fl">4.3630</span>, <span class="fl">3.5519</span>, <span class="fl">4.0534</span>, <span class="fl">4.0031</span>, <span class="fl">5.1495</span>, <span class="fl">4.5581</span>, <span class="fl">4.1959</span>, <span class="fl">3.5946</span>, </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>           <span class="fl">5.1642</span>, <span class="fl">4.0103</span>, <span class="fl">3.6354</span>, <span class="fl">4.2529</span>, <span class="fl">3.5171</span>, <span class="fl">4.4485</span>, <span class="fl">5.3879</span>, <span class="fl">3.4132</span>, </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>           <span class="fl">3.8905</span>, <span class="fl">4.3263</span>, <span class="fl">4.2203</span>, <span class="fl">3.9451</span>, <span class="fl">3.9024</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>y <span class="ot">&lt;-</span> width</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>design</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   run.order std.order  Ac    Ea vf_a vf_p      y
1          1         1 0.1 22.16  3.5  100 5.3533
2          2         2 0.3 22.16  3.5  100 5.2615
3          3         3 0.1 28.48  3.5  100 5.0008
4          4         4 0.3 28.48  3.5  100 4.2712
5          5         5 0.2 25.32  3.0   80 4.5840
6          6         6 0.2 25.32  4.0   80 2.7470
7          7         7 0.2 25.32  3.0  120 3.8086
8          8         8 0.2 25.32  4.0  120 3.9839
9          9         9 0.1 25.32  3.5   80 4.3630
10        10        10 0.3 25.32  3.5   80 3.5519
11        11        11 0.1 25.32  3.5  120 4.0534
12        12        12 0.3 25.32  3.5  120 4.0031
13        13        13 0.2 22.16  3.0  100 5.1495
14        14        14 0.2 28.48  3.0  100 4.5581
15        15        15 0.2 22.16  4.0  100 4.1959
16        16        16 0.2 28.48  4.0  100 3.5946
17        17        17 0.1 25.32  3.0  100 5.1642
18        18        18 0.3 25.32  3.0  100 4.0103
19        19        19 0.1 25.32  4.0  100 3.6354
20        20        20 0.3 25.32  4.0  100 4.2529
21        21        21 0.2 22.16  3.5   80 3.5171
22        22        22 0.2 28.48  3.5   80 4.4485
23        23        23 0.2 22.16  3.5  120 5.3879
24        24        24 0.2 28.48  3.5  120 3.4132
25        25        25 0.2 25.32  3.5  100 3.8905
26        26        26 0.2 25.32  3.5  100 4.3263
27        27        27 0.2 25.32  3.5  100 4.2203
28        28        28 0.2 25.32  3.5  100 3.9451
29        29        29 0.2 25.32  3.5  100 3.9024

Data are stored in coded form using these coding formulas ...
x1 ~ (Ac - 0.2)/0.1
x2 ~ (Ea - 25.32)/3.16
x3 ~ (vf_a - 3.5)/0.5
x4 ~ (vf_p - 100)/20</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>rsm.bbd <span class="ot">&lt;-</span> <span class="fu">rsm</span>(y <span class="sc">~</span> <span class="fu">SO</span>(x1,x2,x3,x4),</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> design)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rsm.bbd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rsm(formula = y ~ SO(x1, x2, x3, x4), data = design)

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  4.056920   0.081357 49.8655 &lt; 2.2e-16 ***
x1          -0.184933   0.052516 -3.5215 0.0033875 ** 
x2          -0.298233   0.052516 -5.6789 5.693e-05 ***
x3          -0.405417   0.052516 -7.7199 2.068e-06 ***
x4           0.119883   0.052516  2.2828 0.0385872 *  
x1:x2       -0.159450   0.090960 -1.7530 0.1014672    
x1:x3        0.442850   0.090960  4.8686 0.0002485 ***
x1:x4        0.190200   0.090960  2.0910 0.0552423 .  
x2:x3       -0.002475   0.090960 -0.0272 0.9786765    
x2:x4       -0.726525   0.090960 -7.9873 1.395e-06 ***
x3:x4        0.503075   0.090960  5.5307 7.405e-05 ***
x1^2         0.323777   0.071429  4.5328 0.0004688 ***
x2^2         0.477602   0.071429  6.6864 1.033e-05 ***
x3^2        -0.080797   0.071429 -1.1312 0.2769959    
x4^2        -0.308648   0.071429 -4.3210 0.0007043 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Multiple R-squared:  0.9599,    Adjusted R-squared:  0.9198 
F-statistic: 23.94 on 14 and 14 DF,  p-value: 2.31e-07

Analysis of Variance Table

Response: y
                    Df Sum Sq Mean Sq F value    Pr(&gt;F)
FO(x1, x2, x3, x4)   4 3.6225 0.90563 27.3647 1.738e-06
TWI(x1, x2, x3, x4)  6 4.1546 0.69243 20.9225 3.067e-06
PQ(x1, x2, x3, x4)   4 3.3140 0.82850 25.0338 2.984e-06
Residuals           14 0.4633 0.03310                  
Lack of fit         10 0.3000 0.03000  0.7347    0.6856
Pure error           4 0.1633 0.04083                  

Stationary point of response surface:
        x1         x2         x3         x4 
 1.0579092  0.1742857 -0.8902676 -0.4104952 

Stationary point in original units:
        Ac         Ea       vf_a       vf_p 
 0.3057909 25.8707427  3.0548662 91.7900965 

Eigenanalysis:
eigen() decomposition
$values
[1]  0.6966486  0.3725336 -0.0899158 -0.5673314

$vectors
         [,1]        [,2]       [,3]        [,4]
x1  0.4113305  0.78063120  0.4678823  0.05008278
x2 -0.7896263  0.50636028 -0.1821966  0.29477793
x3  0.2429853  0.36542084 -0.7745350 -0.45554504
x4  0.3850399 -0.02611146 -0.3846896  0.83849651</code></pre>
</div>
</div>
<p>Gráficos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rsm.bbd, <span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3<span class="sc">+</span>x4, <span class="at">image =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(rsm.bbd, <span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3<span class="sc">+</span>x4, <span class="at">zlab =</span> <span class="st">"y(mm)"</span>,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">50</span>), <span class="at">contours =</span> <span class="st">"colors"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RSM_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Otimização restrita.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>otimo <span class="ot">&lt;-</span> <span class="fu">steepest</span>(rsm.bbd, <span class="at">dist =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>), <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">descent =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Path of steepest descent from ridge analysis:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>otimo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dist     x1     x2    x3     x4 |     Ac       Ea   vf_a   vf_p |  yhat
1   0.0  0.000  0.000 0.000  0.000 | 0.2000 25.32000 3.5000 100.00 | 4.057
2   0.1  0.027  0.045 0.080 -0.028 | 0.2027 25.46220 3.5400  99.44 | 4.004
3   0.2  0.041  0.068 0.167 -0.077 | 0.2041 25.53488 3.5835  98.46 | 3.950
4   0.3  0.043  0.067 0.249 -0.147 | 0.2043 25.53172 3.6245  97.06 | 3.893
5   0.4  0.040  0.052 0.322 -0.228 | 0.2040 25.48432 3.6610  95.44 | 3.829
6   0.5  0.035  0.031 0.387 -0.313 | 0.2035 25.41796 3.6935  93.74 | 3.755
7   0.6  0.030  0.006 0.448 -0.399 | 0.2030 25.33896 3.7240  92.02 | 3.671
8   0.7  0.024 -0.020 0.504 -0.485 | 0.2024 25.25680 3.7520  90.30 | 3.576
9   0.8  0.019 -0.048 0.558 -0.571 | 0.2019 25.16832 3.7790  88.58 | 3.471
10  0.9  0.014 -0.076 0.611 -0.656 | 0.2014 25.07984 3.8055  86.88 | 3.355
11  1.0  0.008 -0.104 0.662 -0.742 | 0.2008 24.99136 3.8310  85.16 | 3.227
12  1.1  0.003 -0.133 0.713 -0.828 | 0.2003 24.89972 3.8565  83.44 | 3.087
13  1.2 -0.002 -0.161 0.762 -0.913 | 0.1998 24.81124 3.8810  81.74 | 2.938
14  1.3 -0.008 -0.190 0.811 -0.998 | 0.1992 24.71960 3.9055  80.04 | 2.777
15  1.4 -0.013 -0.219 0.860 -1.082 | 0.1987 24.62796 3.9300  78.36 | 2.606</code></pre>
</div>
</div>
</section>
<section id="fatorial-3k-para-rsm" class="level2">
<h2 class="anchored" data-anchor-id="fatorial-3k-para-rsm">Fatorial 3^k para RSM</h2>
<p>Eletropolimento.</p>
<ul>
<li>x1: voltagem (4,6,8) V</li>
<li>x2: tempo (30,45,60) min</li>
<li>x3: temperatura (20,40,60) ºC</li>
</ul>
<p>y: profundidade de polimento (um).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>plan <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x3 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.032</span>, <span class="fl">8.545</span>, <span class="fl">10.328</span>, <span class="fl">4.451</span>, <span class="fl">7.009</span>, <span class="fl">12.437</span>, <span class="fl">5.088</span>, <span class="fl">8.409</span>, <span class="fl">13.438</span>, <span class="fl">5.719</span>, <span class="fl">10.81</span>, <span class="fl">17.368</span>, <span class="fl">6.494</span>, <span class="fl">13.124</span>, <span class="fl">33.127</span>, <span class="fl">10.27</span>, <span class="fl">19.943</span>, <span class="fl">59.087</span>, <span class="fl">10.834</span>, <span class="fl">20.873</span>, <span class="fl">51.136</span>, <span class="fl">13.64</span>, <span class="fl">28.244</span>, <span class="fl">67.712</span>, <span class="fl">16.175</span>, <span class="fl">43.145</span>, <span class="fl">79.951</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>plan<span class="sc">$</span>y <span class="ot">&lt;-</span> d</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>plan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x1 x2 x3      y
1  -1 -1 -1  4.032
2   0 -1 -1  8.545
3   1 -1 -1 10.328
4  -1  0 -1  4.451
5   0  0 -1  7.009
6   1  0 -1 12.437
7  -1  1 -1  5.088
8   0  1 -1  8.409
9   1  1 -1 13.438
10 -1 -1  0  5.719
11  0 -1  0 10.810
12  1 -1  0 17.368
13 -1  0  0  6.494
14  0  0  0 13.124
15  1  0  0 33.127
16 -1  1  0 10.270
17  0  1  0 19.943
18  1  1  0 59.087
19 -1 -1  1 10.834
20  0 -1  1 20.873
21  1 -1  1 51.136
22 -1  0  1 13.640
23  0  0  1 28.244
24  1  0  1 67.712
25 -1  1  1 16.175
26  0  1  1 43.145
27  1  1  1 79.951</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>res.fat3k <span class="ot">&lt;-</span> <span class="fu">rsm</span>(y <span class="sc">~</span> <span class="fu">SO</span>(x1,x2,x3), <span class="at">data =</span> plan)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res.fat3k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rsm(formula = y ~ SO(x1, x2, x3), data = plan)

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  14.9655     2.5273  5.9216 1.674e-05 ***
x1           14.8823     1.1699 12.7210 4.101e-10 ***
x2            6.4367     1.1699  5.5019 3.888e-05 ***
x3           14.3318     1.1699 12.2505 7.331e-10 ***
x1:x2         5.2247     1.4328  3.6464  0.001997 ** 
x1:x3        11.2932     1.4328  7.8817 4.468e-07 ***
x2:x3         4.3665     1.4328  3.0475  0.007279 ** 
x1^2          5.6157     2.0263  2.7714  0.013068 *  
x2^2          1.2597     2.0263  0.6217  0.542402    
x3^2          2.9757     2.0263  1.4685  0.160221    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Multiple R-squared:  0.9626,    Adjusted R-squared:  0.9427 
F-statistic: 48.57 on 9 and 17 DF,  p-value: 2.288e-10

Analysis of Variance Table

Response: y
                Df Sum Sq Mean Sq  F value    Pr(&gt;F)
FO(x1, x2, x3)   3 8429.7 2809.89 114.0562 1.841e-11
TWI(x1, x2, x3)  3 2086.8  695.60  28.2349 7.885e-07
PQ(x1, x2, x3)   3  251.9   83.96   3.4079   0.04158
Residuals       17  418.8   24.64                   
Lack of fit     17  418.8   24.64      NaN       NaN
Pure error       0    0.0     NaN                   

Stationary point of response surface:
        x1         x2         x3 
-1.6968254  1.6305105 -0.3845999 

Eigenanalysis:
eigen() decomposition
$values
[1] 11.2536429  0.1049097 -1.5073860

$vectors
         [,1]       [,2]        [,3]
x1 -0.7402642  0.2841502  0.60931734
x2 -0.3223851 -0.9453302  0.04917908
x3 -0.5899804  0.1600293 -0.79139990</code></pre>
</div>
</div>
<p>Otimização restrita.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  d_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res.fat3k,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x[<span class="dv">1</span>],</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x2 =</span> x[<span class="dv">2</span>],</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x3 =</span> x[<span class="dv">3</span>]))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(d_hat)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>otim <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">fn =</span> d,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">lower =</span> <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">upper =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>otim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1]  0.1456229 -1.0000000 -1.0000000

$value
[1] 2.679783

$counts
function gradient 
      27       27 

$convergence
[1] 0

$message
[1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>otim<span class="sc">$</span>value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.679783</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>xotim <span class="ot">&lt;-</span> otim<span class="sc">$</span>par</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>voltagem <span class="ot">&lt;-</span> xotim[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">6</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>tempo <span class="ot">&lt;-</span> xotim[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">15</span> <span class="sc">+</span> <span class="dv">45</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>temperatura <span class="ot">&lt;-</span> xotim[<span class="dv">3</span>]<span class="sc">*</span><span class="dv">20</span> <span class="sc">+</span> <span class="dv">40</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(voltagem,tempo,temperatura)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  6.291246 30.000000 20.000000</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>